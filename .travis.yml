matrix:
  include:
  - name: "Build Android"
    os: linux
    sudo: required
    language: android
    android:
      components:
        - tools
        - platform-tools
        - tools
        - build-tools-27.0.3
        - android-27
      licenses:
        - 'android-sdk-preview-license-.+'
        - 'android-sdk-license-.+'
        - 'google-gdk-license-.+'
    before_install:
      - nvm install node;
      - nvm use node;
      - npm install -g cordova ionic
    before_script:
      - ionic cordova platform add android
    script:
      - ionic cordova build android
      - ionic cordova build android --prod
  - name: "Build iOS"
    os: osx
    language: objective-c
    before_install:
      - nvm install node;
      - nvm use node;
      - npm install -g cordova ionic
    before_script:
      - ionic cordova platform add ios
    script:
      - ionic cordova build ios
      - ionic cordova build ios --prod
  - name: "Build Windows (UWP)"
    os: windows
    language: node_js
    node_js: node
    before_install:
      - npm install -g cordova ionic
    before_script:
      - ionic cordova platform add windows
    script:
      - ionic cordova build windows
      - ionic cordova build windows --prod
  - name: "Test on Chrome and Firefox Quantum"
    os: linux
    language: node_js
    node_js: node
    addons:
      chrome: stable
      firefox: latest
    before_install:
      - npm install karma-firefox-launcher --save-dev
    script:
      - npm run test -- --watch=false --progress=false
      - sed -i 's/chrome/firefox/' src/karma.conf.js
      - sed -i 's/Chrome/Firefox/' src/karma.conf.js
      - npm run test -- --watch=false --progress=false
cache:
  directories:
    - node_modules
install:
  - npm install
